d(e=!1){this.recording=!0;const t=this.axisParams.acceleration;try{if(e|=this.dontShowModal,-1!==this.calibrationMovement&&!e)return void(this.showDialog=!0);if(!this.customGCODE&&0===this.calibrationMovement)return void(this.error="Enter a custom GCODE command before recording.");await this.sendCode({code:`M201 ${this.axisParams.letter}${this.moveAcceleration}`,log:!1}),console.log(this.stepCommand);const t=0===this.calibrationMovement?this.GCODECommand+"\n"+this.customGCODE:this.GCODECommand+"\n"+this.stepCommand();this.recordingProgress=-1;const s=await this.sendCode({code:t,fromInput:!1});if(s.startsWith("Error: "))return void(this.error=s);s.startsWith("Warning: ")&&(this.warning=s),this.error=null,this.warning=null}finally{await this.sendCode({code:`M201 ${this.axisParams.letter}${t}`,log:!1}),await setTimeout((()=>{this.recording=!1}),1e3)}},stepCommand(){return`G91 G1 H2 ${this.axisParams.letter}${this.moveDistance} F${60*this.moveSpeed} \n G4 P100 \n G1 H2 ${this.axisParams.letter}-${this.moveDistance} F${60*this.moveSpeed} G90`},checkTerm(e){return""!=e&&e>=0},async updatePID(){if(this.checkTerm(this.pTerm)&&this.checkTerm(this.iTerm)&&this.checkTerm(this.dTerm))try{this.updatingPIDValue=!0,await this.sendCode({code:`M569.1 P${this.selectedDriver}  R${this.pTerm} I${this.iTerm} D${this.dTerm} A${this.aTerm} V${this.vTerm}`,log:!0})}finally{this.updatingPIDValue=!1}else console.log("error")},async autoTune(){try{if(null===this.axisParams)return;this.error=null,this.autoTuning=!0,this.autoTuner=new a["default"](this.sendCode,this.getFileList,this.download,this.selectedDriver,this.updateGraph,this.updateAutotuneText,this.axisParams),await this.autoTuner.execute(),this.pTerm=this.autoTuner.pTerm,this.iTerm=this.autoTuner.iTerm,this.dTerm=this.autoTuner.dTerm}catch(e){console.error(e),this.error=e}finally{this.autoTuning=!1}},cancelAutoTune(){this.autoTuner.cancel(),this.autoTuning=!1},updateGraph(e,t,s,i){this.pTerm=t,this.iTerm=s,this.dTerm=i},updateAutotuneText(e){this.autoTuneText=e}},unmounted(){this.cancelAutoTune()},computed:{...(0,i.mapState)("machine/model",{boards:e=>e.boards,axes:e=>e.move.axes}),...(0,i.mapState)("settings",["darkTheme"]),drivers(){let e=[];return this.axes.forEach((t=>{t.drivers.forEach((s=>{this.boards.some((e=>e&&e.canAddress===parseInt(s.board)&&null!=e.closedLoop))&&e.push({name:`${t.letter} axis (driver ${s.board}.${s.driver})`,value:`${s.board}.${s.driver}`})}))})),e},closedLoopPoints(){if(this.selectedDriver){const e=this.selectedDriver.split(".")[0],t=this.boards.find((t=>t.canAddress==e));if(t&&t.closedLoop)return t.closedLoop.points}return null},closedLoopRuns(){if(this.selectedDriver){const e=this.selectedDriver.split(".")[0],t=this.boards.find((t=>t.canAddress==e));if(t&&t.closedLoop)return t.closedLoop.runs}return null},totalTime(){return Math.round(this.sampleCount/this.sampleRate*100)/100},GCODECommand(){const e=`P${this.selectedDriver}`,t=`S${this.sampleCount}`,s=`A${this.activateMode}`,i=`R${this.sampleRateContinuous?0:this.sampleRate}`,l=`D${this.selectedVariables.reduce(((e,t)=>e+t.filterValue),0)}`;return`M569.5 ${e} ${t} ${s} ${i} ${l} V0`},ready(){return null!==this.selectedDriver&&this.selectedVariables.length>0}},watch:{async selectedDriver(e){if(e)try{this.pTerm=0,this.iTerm=0,this.dTerm=0,this.aTerm=0,this.vTerm=0;var t=await this.sendCode({code:`M569.1 P${e}`,log:!1,fromInput:!1});t&&(this.pTerm=t.match(/P=[0-9.]+/)[0].substring(2),this.iTerm=t.match(/I=[0-9.]+/)[0].substring(2),this.dTerm=t.match(/D=[0-9.]+/)[0].substring(2),this.aTerm=t.match(/A=[0-9.]+/)[0].substring(2),this.vTerm=t.match(/V=[0-9.]+/)[0].substring(2));let s=this.axes.filter((e=>e.drivers.some((e=>`${e.board}.${e.driver}`===this.selectedDriver))));s.length>0?(s=s[0],this.moveAcceleration=s.acceleration,this.axisParams=new a.AxisParameters(s.letter,s.acceleration,s.speed,s.stepsPerMm,s.microstepping.value)):this.axisParams=null}catch(s){console.log(s)}},calibrationMovement(){this.activateMode=0},closedLoopPoints(e){null!==this.recordingProgress&&(this.recordingProgress=e/this.sampleCount*100)},closedLoopRuns(){this.recordingProgress=null,this.$emit("recordingFinished")}}}},"./node_modules/thread-loader/dist/cjs.js!./node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/plugins/ClosedLoopTuning/VariableSelector.vue?vue&type=script&lang=js&":function(e,t,s){s.r(t);var i=s("./src/plugins/ClosedLoopTuning/config.js"),l=s("./node_modules/vuex/dist/vuex.esm.js");t["default"]={data:()=>({variables:i.variables,selectedVariables:[]}),props:{value:Array,availableVariables:Array},mounted(){this.selectedVariables=this.value},computed:{...(0,l.mapState)("settings",["darkTheme"]),chartableVariables(){return this.variables.filter((e=>!e.hideSelect))}},watch:{value(){this.selectedVariables=this.value},availableVariables(){this.selectedVariables=this.selectedVariables.filter((e=>this.availableVariables.includes(e.title)))},selectedVariables(){this.$emit("input",this.selectedVariables)}},methods:{selectAll(){this.selectedVariables=this.variables.filter((e=>this.availableVariables.includes(e.title)))}}}},"./node_modules/vuetify/lib/components/VPagination/VPagination.js":function(e,t,s){s.r(t);s("./node_modules/core-js/modules/es.array.push.js"),s("./node_modules/vuetify/src/components/VPagination/VPagination.sass");var i=s("./node_modules/vuetify/lib/components/VIcon/index.js"),l=s("./node_modules/vuetify/lib/directives/resize/index.js"),a=s("./node_modules/vuetify/lib/mixins/colorable/index.js"),o=s("./node_modules/vuetify/lib/mixins/intersectable/index.js"),r=s("./node_modules/vuetify/lib/mixins/themeable/index.js"),n=s("./node_modules/vuetify/lib/util/mixins.js");t["default"]=(0,n["default"])(a["default"],(0,o["default"])({onVisible:["init"]}),r["default"]).extend({name:"v-pagination",directives:{Resize:l["default"]},props:{circle:Boolean,disabled:Boolean,length:{type:Number,default:0,validator:e=>e%1===0},nextIcon:{type:String,default:"$next"},prevIcon:{type:String,default:"$prev"},totalVisible:[Number,String],value:{type:Number,default:0},pageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.page"},currentPageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.currentPage"},previousAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.previous"},nextAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.next"},wrapperAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.wrapper"}},data(){return{maxButtons:0,selected:null}},computed:{classes(){return{"v-pagination":!0,"v-pagination--circle":this.circle,"v-pagination--disabled":this.disabled,...this.themeClasses}},items(){const e=parseInt(this.totalVisible,10);if(0===e||isNaN(this.length)||this.length>Number.MAX_SAFE_INTEGER)return[];const t=Math.min(Math.max(0,e)||this.length,Math.max(0,this.maxButtons)||this.length,this.length);if(this.length<=t)return this.range(1,this.length);const s=t%2===0?1:0,i=Math.floor(t/2),l=this.length-i+1+s;if(this.value>i&&this.value<l){const e=1,t=this.length,l=this.value-i+2,a=this.value+i-2-s,o=l-1===e+1?2:"...",r=a+1===t-1?a+1:"...";return[1,o,...this.range(l,a),r,this.length]}if(this.value===i){const e=this.value+i-1-s;return[...this.range(1,e),"...",this.length]}if(this.value===l){const e=this.value-i+1;return[1,"...",...this.range(e,this.length)]}return[...this.range(1,i),"...",...this.range(l,this.length)]}},watch:{value(){this.init()}},beforeMount(){this.init()},methods:{init(){this.selected=null,this.onResize(),this.$nextTick(this.onResize),setTimeout((()=>this.selected=this.value),100)},onResize(){const e=this.$el&&this.$el.parentElement?this.$el.parentElement.clientWidth:window.innerWidth;this.maxButtons=Math.floor((e-96)/42)},next(e){e.preventDefault(),this.$emit("input",this.value+1),this.$emit("next")},previous(e){e.preventDefault(),this.$emit("input",this.value-1),this.$emit("previous")},range(e,t){const s=[];e=e>0?e:1;for(let i=e;i<=t;i++)s.push(i);return s},genIcon(e,t,s,l,a){return e("li",[e("button",{staticClass:"v-pagination__navigation",class:{"v-pagination__navigation--disabled":s},attrs:{disabled:s,type:"button","aria-label":a},on:s?{}:{click:l}},[e(i["default"],[t])])])},genItem(e,t){const s=t===this.value&&(this.color||"primary"),i=t===this.value,l=i?this.currentPageAriaLabel:this.pageAriaLabel;return e("button",this.setBackgroundColor(s,{staticClass:"v-pagination__item",class:{"v-pagination__item--active":t===this.value},attrs:{type:"button","aria-current":i,"aria-label":this.$vuetify.lang.t(l,t)},on:{click:()=>this.$emit("input",t)}}),[t.toString()])},genItems(e){return this.items.map(((t,s)=>e("li",{key:s},[isNaN(Number(t))?e("span",{class:"v-pagination__more"},[t.toString()]):this.genItem(e,t)])))},genList(e,t){return e("ul",{directives:[{modifiers:{quiet:!0},name:"resize",value:this.onResize}],class:this.classes},t)}},render(e){const t=[this.genIcon(e,this.$vuetify.rtl?this.nextIcon:this.prevIcon,this.value<=1,this.previous,this.$vuetify.lang.t(this.previousAriaLabel)),this.genItems(e),this.genIcon(e,this.$vuetify.rtl?this.prevIcon:this.nextIcon,this.value>=this.length,this.next,this.$vuetify.lang.t(this.nextAriaLabel))];return e("nav",{attrs:{role:"navigation","aria-label":this.$vuetify.lang.t(this.wrapperAriaLabel)}},[this.genList(e,t)])}})},"./node_modules/vuetify/lib/components/VRadioGroup/VRadio.js":function(e,t,s){s.r(t);s("./node_modules/vuetify/src/components/VRadioGroup/VRadio.sass");var i=s("./node_modules/vuetify/lib/components/VLabel/index.js"),l=s("./node_modules/vuetify/lib/components/VIcon/index.js"),a=s("./node_modules/vuetify/lib/components/VInput/index.js"),o=s("./node_modules/vuetify/lib/mixins/binds-attrs/index.js"),r=s("./node_modules/vuetify/lib/mixins/colorable/index.js"),n=s("./node_modules/vuetify/lib/mixins/groupable/index.js"),d=s("./node_modules/vuetify/lib/mixins/rippleable/index.js"),u=s("./node_modules/vuetify/lib/mixins/themeable/index.js"),c=s("./node_modules/vuetify/lib/mixins/selectable/index.js"),h=s("./node_modules/vuetify/lib/util/helpers.js"),m=s("./node_modules/vuetify/lib/util/mixins.js"),p=s("./node_modules/vuetify/lib/util/mergeData.js");const v=(0,m["default"])(o["default"],r["default"],d["default"],(0,n.factory)("radioGroup"),u["default"]);t["default"]=v.extend().extend({name:"v-radio",inheritAttrs:!1,props:{disabled:Boolean,id:String,label:String,name:String,offIcon:{type:String,default:"$radioOff"},onIcon:{type:String,default:"$radioOn"},readonly:Boolean,value:{default:null}},data:()=>({isFocused:!1}),computed:{classes(){return{"v-radio--is-disabled":this.isDisabled,"v-radio--is-focused":this.isFocused,...this.themeClasses,...this.groupClasses}},computedColor(){if(!this.isDisabled)return c["default"].options.computed.computedColor.call(this)},computedIcon(){return this.isActive?this.onIcon:this.offIcon},computedId(){return a["default"].options.computed.computedId.call(this)},hasLabel:a["default"].options.computed.hasLabel,hasState(){return(this.radioGroup||{}).hasState},isDisabled(){return this.disabled||!!this.radioGroup&&this.radioGroup.isDisabled},isReadonly(){return this.readonly||!!this.radioGroup&&this.radioGroup.isReadonly},computedName(){return this.name||!this.radioGroup?this.name:this.radioGroup.name||`radio-${this.radioGroup._uid}`},rippleState(){return c["default"].options.computed.rippleState.call(this)},validationState(){return(this.radioGroup||{}).validationState||this.computedColor}},methods:{genInput(e){return c["default"].options.methods.genInput.call(this,"radio",e)},genLabel(){return this.hasLabel?this.$createElement(i["default"],{on:{click:c.prevent},attrs:{for:this.computedId},props:{color:this.validationState,focused:this.hasState}},(0,h.getSlot)(this,"label")||this.label):null},genRadio(){const{title:e,...t}=this.attrs$;return this.$createElement("div",{staticClass:"v-input--selection-controls__input"},[this.$createElement(l["default"],this.setTextColor(this.validationState,{props:{dense:this.radioGroup&&this.radioGroup.dense}}),this.computedIcon),this.genInput({name:this.computedName,value:this.value,...t}),this.genRipple(this.setTextColor(this.rippleState))])},onFocus(e){this.isFocused=!0,this.$emit("focus",e)},onBlur(e){this.isFocused=!1,this.$emit("blur",e)},onChange(){this.isDisabled||this.isReadonly||this.isActive||this.toggle()},onKeydown:()=>{}},render(e){const t={staticClass:"v-radio",class:this.classes,on:(0,p.mergeListeners)({click:this.onChange},this.listeners$),attrs:{title:this.attrs$.title}};return e("div",t,[this.genRadio(),this.genLabel()])}})},"./node_modules/vuetify/lib/components/VRadioGroup/VRadioGroup.js":function(e,t,s){s.r(t);s("./node_modules/vuetify/src/styles/components/_selection-controls.sass"),s("./node_modules/vuetify/src/components/VRadioGroup/VRadioGroup.sass");var i=s("./node_modules/vuetify/lib/components/VInput/index.js"),l=s("./node_modules/vuetify/lib/components/VItemGroup/VItemGroup.js"),a=s("./node_modules/vuetify/lib/util/mixins.js");const o=(0,a["default"])(l.BaseItemGroup,i["default"]);t["default"]=o.extend({name:"v-radio-group",provide(){return{radioGroup:this}},props:{column:{type:Boolean,default:!0},height:{type:[Number,String],default:"auto"},name:String,row:Boolean,value:null},computed:{classes(){return{...i["default"].options.computed.classes.call(this),"v-input--selection-controls v-input--radio-group":!0,"v-input--radio-group--column":this.column&&!this.row,"v-input--radio-group--row":this.row}}},methods:{genDefaultSlot(){return this.$createElement("div",{staticClass:"v-input--radio-group__input",attrs:{id:this.id,role:"radiogroup","aria-labelledby":this.computedId}},i["default"].options.methods.genDefaultSlot.call(this))},genInputSlot(){const e=i["default"].options.methods.genInputSlot.call(this);return delete e.data.on.click,e},genLabel(){const e=i["default"].options.methods.genLabel.call(this);return e?(e.data.attrs.id=this.computedId,delete e.data.attrs.for,e.tag="legend",e):null},onClick:l.BaseItemGroup.options.methods.onClick},render(e){const t=i["default"].options.render.call(this,e);return this._b(t.data,"div",this.attrs$),t}})},"./node_modules/vuetify/lib/components/VRangeSlider/VRangeSlider.js":function(e,t,s){s.r(t);s("./node_modules/core-js/modules/es.array.push.js"),s("./node_modules/vuetify/src/components/VRangeSlider/VRangeSlider.sass");var i=s("./node_modules/vuetify/lib/components/VSlider/index.js"),l=s("./node_modules/vuetify/lib/util/helpers.js");t["default"]=i["default"].extend({name:"v-range-slider",props:{value:{type:Array,default:()=>[0,0]}},data(){return{activeThumb:null,lazyValue:this.value}},computed:{classes(){return{...i["default"].options.computed.classes.call(this),"v-input--range-slider":!0}},internalValue:{get(){return this.lazyValue},set(e){let t=e.map(((e=0)=>this.roundValue(Math.min(Math.max(e,this.minValue),this.maxValue))));if(t[0]>t[1]||t[1]<t[0]){if(null!==this.activeThumb){const e=1===this.activeThumb?0:1,t=this.$refs[`thumb_${e}`];t.focus()}t=[t[1],t[0]]}this.lazyValue=t,(0,l.deepEqual)(t,this.value)||this.$emit("input",t),this.validate()}},inputWidth(){return this.internalValue.map((e=>(this.roundValue(e)-this.minValue)/(this.maxValue-this.minValue)*100))}},methods:{getTrackStyle(e,t,s=0,i=0){const l=this.vertical?this.$vuetify.rtl?"top":"bottom":this.$vuetify.rtl?"right":"left",a=this.vertical?"height":"width",o=`calc(${e}% + ${s}px)`,r=`calc(${t}% + ${i}px)`;return{transition:this.trackTransition,[l]:o,[a]:r}},getIndexOfClosestValue(e,t){return Math.abs(e[0]-t)<Math.abs(e[1]-t)?0:1},genInput(){return(0,l.createRange)(2).map((e=>{const t=i["default"].options.methods.genInput.call(this);return t.data=t.data||{},t.data.attrs=t.data.attrs||{},t.data.attrs.value=this.internalValue[e],t.data.attrs.id=`input-${e?"max":"min"}-${this._uid}`,t}))},genTrackContainer(){const e=[],t=this.isDisabled?10:0,s=[{class:"v-slider__track-background",color:this.computedTrackColor,styles:[0,this.inputWidth[0],0,-t]},{class:this.isDisabled?"v-slider__track-background":"v-slider__track-fill",color:this.isDisabled?this.computedTrackColor:this.computedTrackFillColor,styles:[this.inputWidth[0],Math.abs(this.inputWidth[1]-this.inputWidth[0]),t,-2*t]},{class:"v-slider__track-background",color:this.computedTrackColor,styles:[this.inputWidth[1],Math.abs(100-this.inputWidth[1]),t,-t]}];r"use strict";(self["webpackChunkduetwebcontrol"]=self["webpackChunkduetwebcontrol"]||[]).push([["ClosedLoopTuning"],{"./src/plugins/ClosedLoopTuning/Chart.vue":function(e,t,s){s.r(t);var i=s("./node_modules/vuetify-loader/lib/loader.js??ruleSet[1].rules[0].use!./node_modules/thread-loader/dist/cjs.js!./node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??ruleSet[1].rules[5]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/plugins/ClosedLoopTuning/Chart.vue?vue&type=template&id=f2e130a0&scoped=true&"),l=s("./src/plugins/ClosedLoopTuning/Chart.vue?vue&type=script&lang=js&"),a=(s("./src/plugins/ClosedLoopTuning/Chart.vue?vue&type=style&index=0&id=f2e130a0&prod&scoped=true&lang=css&"),s("./node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js")),o=(0,a["default"])(l["default"],i.render,i.staticRenderFns,!1,null,"f2e130a0",null);t["default"]=o.exports},"./src/plugins/ClosedLoopTuning/ClosedLoopTuning.vue":function(e,t,s){s.r(t);var i=s("./node_modules/vuetify-loader/lib/loader.js??ruleSet[1].rules[0].use!./node_modules/thread-loader/dist/cjs.js!./node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??ruleSet[1].rules[5]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/plugins/ClosedLoopTuning/ClosedLoopTuning.vue?vue&type=template&id=50a890d8&"),l=s("./src/plugins/ClosedLoopTuning/ClosedLoopTuning.vue?vue&type=script&lang=js&"),a=s("./node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js"),o=(0,a["default"])(l["default"],i.render,i.staticRenderFns,!1,null,null,null);t["default"]=o.exports},"./src/plugins/ClosedLoopTuning/FileSelector.vue":function(e,t,s){s.r(t);var i=s("./node_modules/vuetify-loader/lib/loader.js??ruleSet[1].rules[0].use!./node_modules/thread-loader/dist/cjs.js!./node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??ruleSet[1].rules[5]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/plugins/ClosedLoopTuning/FileSelector.vue?vue&type=template&id=08d365b5&"),l=s("./src/plugins/ClosedLoopTuning/FileSelector.vue?vue&type=script&lang=js&"),a=(s("./src/plugins/ClosedLoopTuning/FileSelector.vue?vue&type=style&index=0&id=08d365b5&prod&lang=scss&"),s("./node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js")),o=(0,a["default"])(l["default"],i.render,i.staticRenderFns,!1,null,null,null);t["default"]=o.exports},"./src/plugins/ClosedLoopTuning/Recorder.vue":function(e,t,s){s.r(t);var i=s("./node_modules/vuetify-loader/lib/loader.js??ruleSet[1].rules[0].use!./node_modules/thread-loader/dist/cjs.js!./node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??ruleSet[1].rules[5]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/plugins/ClosedLoopTuning/Recorder.vue?vue&type=template&id=3b40ed2e&"),l=s("./src/plugins/ClosedLoopTuning/Recorder.vue?vue&type=script&lang=js&"),a=s("./node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js"),o=(0,a["default"])(l["default"],i.render,i.staticRenderFns,!1,null,null,null);t["default"]=o.exports},"./src/plugins/ClosedLoopTuning/VariableSelector.vue":function(e,t,s){s.r(t);var i=s("./node_modules/vuetify-loader/lib/loader.js??ruleSet[1].rules[0].use!./node_modules/thread-loader/dist/cjs.js!./node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??ruleSet[1].rules[5]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/plugins/ClosedLoopTuning/VariableSelector.vue?vue&type=template&id=7ec396c0&"),l=s("./src/plugins/ClosedLoopTuning/VariableSelector.vue?vue&type=script&lang=js&"),a=s("./node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js"),o=(0,a["default"])(l["default"],i.render,i.staticRenderFns,!1,null,null,null);t["default"]=o.exports},"./src/plugins/ClosedLoopTuning/Chart.vue?vue&type=style&index=0&id=f2e130a0&prod&scoped=true&lang=css&":function(e,t,s){s.r(t);s("./node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-12.use[0]!./node_modules/css-loader/dist/cjs.js??clonedRuleSet-12.use[1]!./node_modules/@vue/vue-loader-v15/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-12.use[2]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/plugins/ClosedLoopTuning/Chart.vue?vue&type=style&index=0&id=f2e130a0&prod&scoped=true&lang=css&")},"./src/plugins/ClosedLoopTuning/FileSelector.vue?vue&type=style&index=0&id=08d365b5&prod&lang=scss&":function(e,t,s){s.r(t);s("./node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-22.use[0]!./node_modules/css-loader/dist/cjs.js??clonedRuleSet-22.use[1]!./node_modules/@vue/vue-loader-v15/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-22.use[2]!./node_modules/sass-loader/dist/cjs.js??clonedRuleSet-22.use[3]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/plugins/ClosedLoopTuning/FileSelector.vue?vue&type=style&index=0&id=08d365b5&prod&lang=scss&")},"./src/plugins/ClosedLoopTuning/Chart.vue?vue&type=script&lang=js&":function(e,t,s){s.r(t);var i=s("./node_modules/thread-loader/dist/cjs.js!./node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/plugins/ClosedLoopTuning/Chart.vue?vue&type=script&lang=js&");t["default"]=i["default"]},"./src/plugins/ClosedLoopTuning/ClosedLoopTuning.vue?vue&type=script&lang=js&":function(e,t,s){s.r(t);var i=s("./node_modules/thread-loader/dist/cjs.js!./node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/plugins/ClosedLoopTuning/ClosedLoopTuning.vue?vue&type=script&lang=js&");t["default"]=i["default"]},"./src/plugins/ClosedLoopTuning/FileSelector.vue?vue&type=script&lang=js&":function(e,t,s){s.r(t);var i=s("./node_modules/thread-loader/dist/cjs.js!./node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/plugins/ClosedLoopTuning/FileSelector.vue?vue&type=script&lang=js&");t["default"]=i["default"]},"./src/plugins/ClosedLoopTuning/Recorder.vue?vue&type=script&lang=js&":function(e,t,s){s.r(t);var i=s("./node_modules/thread-loader/dist/cjs.js!./node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/plugins/ClosedLoopTuning/Recorder.vue?vue&type=script&lang=js&");t["default"]=i["default"]},"./src/plugins/ClosedLoopTuning/VariableSelector.vue?vue&type=script&lang=js&":function(e,t,s){s.r(t);var i=s("./node_modules/thread-loader/dist/cjs.js!./node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/plugins/ClosedLoopTuning/VariableSelector.vue?vue&type=script&lang=js&");t["default"]=i["default"]},"./node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-12.use[0]!./node_modules/css-loader/dist/cjs.js??clonedRuleSet-12.use[1]!./node_modules/@vue/vue-loader-v15/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-12.use[2]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/plugins/ClosedLoopTuning/Chart.vue?vue&type=style&index=0&id=f2e130a0&prod&scoped=true&lang=css&":function(e,t,s){s.r(t)},"./node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-22.use[0]!./node_modules/css-loader/dist/cjs.js??clonedRuleSet-22.use[1]!./node_modules/@vue/vue-loader-v15/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-22.use[2]!./node_modules/sass-loader/dist/cjs.js??clonedRuleSet-22.use[3]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/plugins/ClosedLoopTuning/FileSelector.vue?vue&type=style&index=0&id=08d365b5&prod&lang=scss&":function(e,t,s){s.r(t)},"./node_modules/vuetify/src/components/VPagination/VPagination.sass":function(e,t,s){s.r(t)},"./node_modules/vuetify/src/components/VRadioGroup/VRadio.sass":function(e,t,s){s.r(t)},"./node_modules/vuetify/src/components/VRadioGroup/VRadioGroup.sass":function(e,t,s){s.r(t)},"./node_modules/vuetify/src/components/VRangeSlider/VRangeSlider.sass":function(e,t,s){s.r(t)},"./src/utils/csv.ts":function(e,t,s){s.r(t);var i=s("./node_modules/@babel/runtime/helpers/esm/defineProperty.js");s("./node_modules/core-js/modules/es.array.push.js");class CSV{constructor(e){(0,i["default"])(this,"headers",[]),(0,i["default"])(this,"content",[]);let t=0,s=0,l=!1;for(let i=0;i<e.length;i++){const a=e[i],o=e[i+1];0===t?this.headers.length<=s&&this.headers.push(""):(this.content.length<t&&this.content.push([]),this.content[t-1].length<=s&&this.content[t-1].push("")),l&&'"'===a&&'"'===o?(0===t?this.headers[s]+=a:this.content[t-1][s]+=a,i++):'"'!==a?","!==a||l?"\n"!==a||l?0===t?this.headers[s]+=a:this.content[t-1][s]+=a:(this.content.push([]),s=0,++t):s++:l=!l}this.content.length>0&&0===this.content[this.content.length-1].length&&this.content.splice(-1,1)}get(e,t=0){const s=this.headers.findIndex((t=>t===e));if(-1!==s)return this.content[t][s]}}t["default"]=CSV},"./node_modules/thread-loader/dist/cjs.js!./node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/plugins/ClosedLoopTuning/Chart.vue?vue&type=script&lang=js&":function(e,t,s){s.r(t);var i=s("./node_modules/chart.js/dist/Chart.js"),l=s.n(i),a=s("./src/plugins/ClosedLoopTuning/config.js"),o=s("./node_modules/vuex/dist/vuex.esm.js");t["default"]={data(){return{chart:null,rangeFilter:[0,0]}},props:{data:Object,variables:Array},computed:{...(0,o.mapState)("settings",["darkTheme"])},methods:{createChart(){l().Tooltip.positioners.cursor=function(e,t){return t},this.chart=new(l().Line)(this.$refs.chart,{options:{animation:{duration:0},tooltips:{mode:"index",position:"cursor",intersect:!1},maintainAspectRatio:!1,scales:{xAxes:[{type:"linear",scaleLabel:{display:!0,labelString:"Time Since Start (ms)"}}]}},data:{datasets:[]}}),this.updateChart()},updateChart(){if(this.data){this.chart.data.datasets=this.variables.map((e=>({borderColor:this.darkTheme?e.colour.dark:e.colour.light,borderWidth:1,data:this.data[e.title]?this.data[e.title].map(((t,s)=>({x:this.data.Timestamp[s],y:e.filter?e.filter(t):t}))).slice(this.rangeFilter[0],this.rangeFilter[1]):[],fill:!1,label:e.title,pointRadius:0,showLine:!0,tension:0,yAxisID:e.axis})));const e=this.variables.map((e=>e.axis));this.chart.options.scales.yAxes=a.yAxes.filter((t=>e.includes(t.id)))}else this.chart.data.datasets=[],this.chart.options.scales.yAxes=[];this.chart.update()}},mounted(){this.createChart()},watch:{variables(){this.updateChart()},data(){this.data?this.rangeFilter=[0,this.data.Sample.length-1]:this.updateChart()},rangeFilter(){this.updateChart()},darkTheme(){this.updateChart()}}}},"./node_modules/thread-loader/dist/cjs.js!./node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/plugins/ClosedLoopTuning/ClosedLoopTuning.vue?vue&type=script&lang=js&":function(e,t,s){s.r(t);s("./node_modules/core-js/modules/es.array.push.js");var i=s("./node_modules/vuex/dist/vuex.esm.js"),l=s("./src/plugins/ClosedLoopTuning/Chart.vue"),a=s("./src/plugins/ClosedLoopTuning/Recorder.vue"),o=s("./src/plugins/ClosedLoopTuning/FileSelector.vue"),r=s("./src/plugins/ClosedLoopTuning/VariableSelector.vue");t["default"]={components:{Chart:l["default"],Recorder:a["default"],FileSelector:o["default"],VariableSelector:r["default"]},data:()=>({loadedData:null,variablesToView:[],variablesToRecord:[],availableVariables:[]}),computed:{...(0,i.mapGetters)(["isConnected","uiFrozen"])},methods:{...(0,i.mapActions)("machine",["download"]),parseClosedLoopCSV(e){e=e.split("\n");const t=e[0].split(",");let s={};for(let i of t)s[i]=[];return e.slice(1).forEach((e=>{if(""!==e){e=e.split(",");for(let t=0;t<e.length;t++)s[Object.keys(s)[t]].push(parseFloat(e[t]))}})),s},async selected(e){if(e){let t=this.parseClosedLoopCSV(await this.download({filename:e,type:"text",showProgress:!1,showSuccess:!1,showError:!1}));this.availableVariables=Object.keys(t).filter((e=>"Sample"!==e)),this.loadedData=t}else this.loadedData=null},recordingFinished(){this.$refs.selector.selectMostRecentFile()}}}},"./node_modules/thread-loader/dist/cjs.js!./node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/plugins/ClosedLoopTuning/FileSelector.vue?vue&type=script&lang=js&":function(e,t,s){s.r(t);var i=s("./node_modules/vuex/dist/vuex.esm.js"),l=s("./src/utils/path.ts");t["default"]={data:()=>({page:1,files:[],loading:!1,selectedIndex:-1,maxFileDisplay:13,deleteDialog:!1,isDeleting:!1,deleteProgress:0}),computed:{...(0,i.mapGetters)(["isConnected","uiFrozen"]),displayedFiles(){return this.files.slice((this.page-1)*this.maxFileDisplay,this.page*this.maxFileDisplay)}},mounted(){this.refresh(),this.$root.$on("updatePIDGraph",(()=>{this.selectMostRecentFile()}))},unmounted(){this.$root.$off("updatePIDGraph")},methods:{...(0,i.mapActions)("machine",{getFileList:"getFileList",machineDelete:"delete"}),async refresh(){if(!this.isConnected)return this.selectedIndex=-1,void(this.files=[]);if(!this.loading){this.selectedIndex=-1,this.loading=!0;try{this.files=(await this.getFileList(l["default"].closedLoop)).filter((e=>!e.isDirectory&&e.name.endsWith(".csv"))).sort(((e,t)=>t.lastModified-e.lastModified))}finally{this.loading=!1}}},async selectMostRecentFile(){await this.refresh(),this.page=1,this.selectedIndex=0},async deleteFile(e){try{await this.machineDelete(l["default"].combine(l["default"].closedLoop,e)),await this.refresh()}catch(t){this.$makeNotification("error",this.$t("notification.delete.errorTitle",[e]),t.message)}},async deletePage(){for(let t=(this.page-1)*this.maxFileDisplay;t<this.page*this.maxFileDisplay;t++)if(!(t>=this.files.length))try{await this.machineDelete(l["default"].combine(l["default"].closedLoop,this.files[t].name))}catch(e){this.$makeNotification("error",this.$t("notification.delete.errorTitle",[this.files[t].name]),e.message)}await this.refresh()},async deleteAll(){try{this.deleteDialog=!1,this.isDeleting=!0;for(let t=0;t<this.files.length;t++)try{this.deleteProgress=t/this.files.length*100,await this.machineDelete(l["default"].combine(l["default"].closedLoop,this.files[t].name))}catch(e){this.$makeNotification("error",this.$t("notification.delete.errorTitle",[this.files[t].name]),e.message)}await this.refresh()}finally{this.isDeleting=!1,this.deleteProgress=0}}},watch:{selectedIndex(e){this.$emit("fileSelect",e>=0&&e<this.files.length?l["default"].combine(l["default"].closedLoop,this.files[e].name):null)}}}},"./node_modules/thread-loader/dist/cjs.js!./node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/plugins/ClosedLoopTuning/Recorder.vue?vue&type=script&lang=js&":function(e,t,s){s.r(t);s("./node_modules/core-js/modules/es.array.push.js");var i=s("./node_modules/vuex/dist/vuex.esm.js"),l=s("./src/plugins/ClosedLoopTuning/config.js"),a=s("./src/plugins/ClosedLoopTuning/PIDTune.js");t["default"]={data:()=>({variables:l.variables,error:null,warning:null,sampleRate:100,activateMode:0,tuningManoeuvres:l.tuningManoeuvres,sampleCount:500,customGCODE:null,showDialog:!1,selectedDriver:null,dontShowModal:!1,selectedVariables:[],calibrationMovement:64,recordingProgress:null,sampleRateContinuous:!0,pTerm:0,iTerm:0,dTerm:0,aTerm:0,vTerm:0,updatingPIDValue:!1,autoTuning:!1,autoTuner:null,recording:!1,autoTuneText:"",axisParams:null,moveSpeed:100,moveDistance:50,moveAcceleration:1e4}),methods:{...(0,i.mapActions)("machine",["sendCode","getFileList","download"]),nthThirdOfVariables(e){let t=this.variables.filter((e=>!e.hideRecord)),s=Math.ceil(t.length/3);return t.slice(e*s,(e+1)*s)},dialogResult(e){this.showDialog=!1,e&&this.record(!0)},async recoreturn this.$vuetify.rtl&&s.reverse(),e.push(...s.map((e=>this.$createElement("div",this.setBackgroundColor(e.color,{staticClass:e.class,style:this.getTrackStyle(...e.styles)}))))),this.$createElement("div",{staticClass:"v-slider__track-container",ref:"track"},e)},genChildren(){return[this.genInput(),this.genTrackContainer(),this.genSteps(),(0,l.createRange)(2).map((e=>{const t=this.internalValue[e],onFocus=t=>{this.isFocused=!0,this.activeThumb=e,this.$emit("focus",t)},onBlur=e=>{this.isFocused=!1,this.activeThumb=null,this.$emit("blur",e)},s=this.inputWidth[e],i=this.isActive&&this.activeThumb===e,l=this.isFocused&&this.activeThumb===e;return this.genThumbContainer(t,s,i,l,onFocus,onBlur,`thumb_${e}`)}))]},reevaluateSelected(e){this.activeThumb=this.getIndexOfClosestValue(this.internalValue,e);const t=`thumb_${this.activeThumb}`,s=this.$refs[t];s.focus()},onSliderMouseDown(e){var t;const s=this.parseMouseMove(e);if(this.reevaluateSelected(s),this.oldValue=this.internalValue,this.isActive=!0,null===(t=e.target)||void 0===t?void 0:t.matches(".v-slider__thumb-container, .v-slider__thumb-container *")){this.thumbPressed=!0;const t=e.target.getBoundingClientRect(),s="touches"in e?e.touches[0]:e;this.startOffset=this.vertical?s.clientY-(t.top+t.height/2):s.clientX-(t.left+t.width/2)}else this.startOffset=0,window.clearTimeout(this.mouseTimeout),this.mouseTimeout=window.setTimeout((()=>{this.thumbPressed=!0}),300);const i=!l.passiveSupported||{passive:!0,capture:!0},a=!!l.passiveSupported&&{passive:!0},o="touches"in e;this.onMouseMove(e),this.app.addEventListener(o?"touchmove":"mousemove",this.onMouseMove,a),(0,l.addOnceEventListener)(this.app,o?"touchend":"mouseup",this.onSliderMouseUp,i),this.$emit("start",this.internalValue)},onSliderClick(e){if(!this.isActive){if(this.noClick)return void(this.noClick=!1);const t=this.parseMouseMove(e);this.reevaluateSelected(t),this.setInternalValue(t),this.$emit("change",this.internalValue)}},onMouseMove(e){const t=this.parseMouseMove(e);"mousemove"===e.type&&(this.thumbPressed=!0),null===this.activeThumb&&(this.activeThumb=this.getIndexOfClosestValue(this.internalValue,t)),this.setInternalValue(t)},onKeyDown(e){if(null===this.activeThumb)return;const t=this.parseKeyDown(e,this.internalValue[this.activeThumb]);null!=t&&(this.setInternalValue(t),this.$emit("change",this.internalValue))},setInternalValue(e){this.internalValue=this.internalValue.map(((t,s)=>s===this.activeThumb?e:Number(t)))}}})},"./node_modules/vuetify/lib/components/VSlider/index.js":function(e,t,s){s.r(t),s.d(t,{VSlider:function(){return i["default"]}});var i=s("./node_modules/vuetify/lib/components/VSlider/VSlider.js");t["default"]=i["default"]},"./src/plugins/ClosedLoopTuning/PIDTune.js":function(e,t,s){s.r(t),s.d(t,{AxisParameters:function(){return AxisParameters}});s("./node_modules/core-js/modules/es.array.push.js");var i=s("./src/utils/path.ts"),l=s("./src/utils/csv.ts");const a=500,o=4,r=.4,n=5e4;class AxisParameters{constructor(e,t,s,i,l){this.letter=e,this.acceleration=t,this.maxSpeed=s,this.stepsPerMM=i,this.microstepping=l}}t["default"]=class{constructor(e,t,s,i,l,a,o){this.pTerm=100,this.iTerm=0,this.dTerm=0,this.aTerm=0,this.vTerm=0,this.warningValue=0,this.errorValue=0,this.selectedDriver=i,this.sendCode=e,this.getFileList=t,this.downloadFile=s,this.updateGraphCallback=l,this.updateAutotuneStatusCallback=a,this.cancelled=!1,this.axisParams=o,this.lastFile=""}cancel(){this.cancelled=!0}async getPID(){const e=await this.sendCode({code:`M569.1 P${this.selectedDriver}`,log:!1,fromInput:!1});if(e){this.pTerm=Number(e.match(/P=[0-9.]+/)[0].substring(2)),this.iTerm=Number(e.match(/I=[0-9.]+/)[0].substring(2)),this.dTerm=Number(e.match(/D=[0-9.]+/)[0].substring(2)),this.aTerm=Number(e.match(/A=[0-9.]+/)[0].substring(2)),this.vTerm=Number(e.match(/V=[0-9.]+/)[0].substring(2));const t=/Warning\/error threshold ([0-9.]+)\/([0-9.]+)/g.exec(e);this.warningValue=Number(t[1]),this.errorValue=Number(t[2])}}async updatePID(){let e=`M569.1 P${this.selectedDriver} R${this.pTerm} I${this.iTerm} D${this.dTerm} E0:0`;await this.sendCode({code:e,log:!1}),await this.sendCode({code:`M569.1 P${this.selectedDriver}`,log:!1})}async resetErrorThreshold(){await this.sendCode({code:`M569.1 P${this.selectedDriver} E${this.warningValue}:${this.errorValue}`,log:!1})}sleep(e){return new Promise((t=>setTimeout(t,e)))}async findP_Test(){let e=!1,t=0;this.pTerm=100,this.iTerm=0,this.dTerm=0,await this.updatePID();while(!e&&t<10){t++;let s=await this.runStepManouver(),i=this.processData(s);if(i.periods.length<8)this.pTerm+=50,this.iTerm=0,this.dTerm=0,await this.updatePID();else{let t=i.periods.slice(1,7).reduce(((e,t)=>e+t),0)/6,s=i.periods.slice(1,7).filter((e=>e<.95*t)),l=i.periods.slice(1,7).filter((e=>e>1.05*t));s.length>1?(this.pTerm+=50,await this.updatePID()):l.length>1?(this.pTerm-=25,await this.updatePID()):e=!0}if(this.pTerm>700)return;await this.sleep(2e3)}}async findP(){let e=!1,t=0;this.pTerm=10,this.iTerm=0,this.dTerm=0,await this.updatePID(),await this.runStepManouver();let s=1e3,i=0;while(!e&&this.pTerm<a){if(this.cancelled)return!1;this.updateStatus(`Autotune: Testing P${this.pTerm}`),await this.updatePID();let l=await this.runStepManouver(),a=this.processData(l),r=a.peaks[0].time;r<s&&Math.abs(r-s)>o?(s=r,this.pTerm<100?this.pTerm+=10:this.pTerm+=25,t=this.pTerm,i=0):i<1?(i++,this.pTerm<100?this.pTerm+=10:this.pTerm+=25):(e=!0,this.pTerm=t,await this.updatePID(),this.updateStatus(`Autotune: P${this.pTerm} found`))}return e}async findD(){let e=!1;this.iTerm=0,this.dTerm=0;while(!e&&this.dTerm<r){if(this.cancelled)return!1;await this.updatePID(),this.updateStatus(`Autotune: Testing D${this.dTerm}`);let s=await this.runStepManouver(),i=this.processData(s);var t=i.peaks.filter((e=>e.step-i.stepTarget>.05));t.length>0?(this.dTerm<.5?this.dTerm+=.01:this.dTerm+=.025,this.dTerm=Number(this.dTerm.toPrecision(3))):e=!0,await this.sleep(1e3)}return e}async findI(){let e=!1,t=0,s=999999,i=0;this.iTerm=1e3;while(!e&&this.iTerm<n){if(this.cancelled)return!1;this.updateStatus(`Autotune: Testing I${this.iTerm}`),await this.updatePID();let l=await this.runStepManouver(!0),a=this.processData(l),o=a.error.filter((e=>Math.abs(e.error)>0)),r=o[o.length-1].time;r<s-25?(s=r,this.iTerm+=1e3,i=this.iTerm,this.iTerm=Math.trunc(this.iTerm),t=0):(t++,this.iTerm+=500,t>1&&(this.iTerm=i,await this.updatePID(),e=!0,this.updateStatus(`Autotune: Testing I${this.iTerm}`))),await this.sleep(2e3)}return e}processData(e){let t=[],s=[],i=[];if(-1==e.measuredIndex||-1==e.targetIndex)return;let l=0,a=!0,o=e.data.content[0][e.measuredIndex]-e.data.content[0][e.targetIndex];for(let u=0;u<e.data.content.length-1;u++){let r=e.data.content[u];r[e.targetIndex]-=o;let n=e.data.content[u+1];l=r[e.targetIndex]>l?r[e.targetIndex]:l,r[e.measuredIndex]>n[e.measuredIndex]&&a&&(t.push({time:r[e.timeStamp],step:r[e.measuredIndex]}),a=!1),r[e.measuredIndex]<n[e.measuredIndex]&&!a&&(s.push({time:r[e.timeStamp],step:r[e.measuredIndex]}),a=!0),r[e.timeStamp]>10&&i.push({time:Number(r[e.timeStamp]),error:r[e.measuredIndex]-r[e.targetIndex]})}let r=[];for(let u=0;u<t.length-1;u++)r.push(t[u+1].time-t[u].time);let n=r.reduce(((e,t)=>e+t),0)/r.length,d=Math.min(t.length,s.length);for(let u=0;u<d;u++);return{peaks:t,valleys:s,periods:r,averagePeriod:n,stepTarget:l,error:i}}fetchCSV(e){let t=new l["default"](e),s=t.headers.indexOf("Timestamp"),i=t.headers.indexOf("Measured Motor Steps"),a=t.headers.indexOf("Target Motor Steps");return{data:t,timeStamp:s,measuredIndex:i,targetIndex:a}}async runStepManouver(e=!1){if(null==this.selectedDriver)return;e?(await this.sendCode({code:`M569.5 P${this.selectedDriver} S500 R250 D6 A0`,log:!0}),await this.sendCode({code:this.generateFourFullStepsGCode(),log:!0}),await this.sleep(3e3)):(await this.sendCode({code:`M569.5 P${this.selectedDriver} S1000 R2000 D6 A0`,log:!0}),await this.sendCode({code:this.generateFourFullStepsGCode(),log:!0}),await this.sleep(3e3));let t=(await this.getFileList(i["default"].closedLoop)).filter((e=>!e.isDirectory&&e.name.endsWith(".csv"))).sort(((e,t)=>t.lastModified-e.lastModified)),s=await this.downloadFile({filename:`${i["default"].closedLoop}/${t[0].name}`,type:"text",showProgress:!1,showSuccess:!1,showError:!0});if(""===s)throw new Error("Could not read data from CSV");if(null!==this.updateGraphCallback&&this.updateGraphCallback(`Path.closedLoop}/${t[0].name}`,this.pTerm,this.iTerm,this.dTerm),!t||0===t.length||this.lastFile===t[0].name)throw new Error("No new data found");return this.lastFile=t[0].name,this.fetchCSV(s)}async execute(){this.cancelled=!1;let e=!0;return await this.getPID(),e=await this.findP(),e&&(e=await this.findD()),e&&(e=await this.findI()),await this.resetErrorThreshold(),await this.sendCode({code:`M117 ${this.selectedDriver}: Tuning Complete `,log:!0}),this.updateStatus(""),!0}updateStatus(e){this.updateAutotuneStatusCallback&&this.updateAutotuneStatusCallback(e)}getFullStep(){return 1/this.axisParams.stepsPerMM*this.axisParams.microstepping}generateFourFullStepsGCode(){const e=`G91 G1 H2 ${this.axisParams.letter}${-16*this.getFullStep()} F${this.axisParams.maxSpeed} G90`;return console.log(e),e}}},"./src/plugins/ClosedLoopTuning/config.js":function(e,t,s){s.r(t),s.d(t,{tuningManoeuvres:function(){return a},variables:function(){return l},yAxes:function(){return i}});let i=[{id:"count",type:"linear",position:"left"},{id:"steps",type:"linear",position:"left"},{id:"degrees",type:"linear",position:"right"},{id:"unitless",type:"linear",position:"right"}],l=[{id:"encoderReading",title:"Raw Encoder Reading",filterValue:1,colour:{light:"#b30000",dark:"#e60049"},axis:"count"},{id:"currentAndTarget",title:"Current and Target Position",filterValue:14,colour:{light:"#7c1158",dark:"#0bb4ff"},axis:"steps",hideSelect:!0},{id:"currentMotorSteps",title:"Measured Motor Steps",filterValue:2,colour:{light:"#7c1158",dark:"#0bb4ff"},axis:"steps",hideRecord:!0},{id:"targetMotorSteps",title:"Target Motor Steps",filterValue:4,colour:{light:"#4421af",dark:"#50e991"},axis:"steps",hideRecord:!0},{id:"currentError",title:"Current Error",filterValue:8,colour:{light:"#1a53ff",dark:"#e6d800"},axis:"steps",hideRecord:!0},{id:"pidControlSignal",title:"PID Control Signal",filterValue:16,colour:{light:"#0d88e6",dark:"#9b19f5"},axis:"unitless"},{id:"pidPTerm",title:"PID P Term",filterValue:32,colour:{light:"#00b7c7",dark:"#ffa300"},axis:"unitless"},{id:"pidITerm",title:"PID I Term",filterValue:64,colour:{light:"#5ad45a",dark:"#dc0ab4"},axis:"unitless"},{id:"pidDTerm",title:"PID D Term",filterValue:128,colour:{light:"#8be04e",dark:"#b3d4ff"},axis:"unitless"},{id:"pidVTerm",title:"PID V Term",filterValue:8192,colour:{light:"#ffa52a",dark:"#0549a7"},axis:"unitless"},{id:"pidATerm",title:"PID A Term",filterValue:16384,colour:{light:"#bf9004",dark:"#8938c9"},axis:"unitless"},{id:"stepPhase",title:"Measured Step Phase",filterValue:256,colour:{light:"#ebdc78",dark:"#00bfa0"},filter:e=>e/4095*360,axis:"degrees"},{id:"desiredStepPhase",title:"Desired Step Phase",filterValue:512,colour:{light:"#fd7f6f",dark:"#fd7f6f"},filter:e=>e/4095*360,axis:"degrees"},{id:"phaseShift",title:"Phase Shift",filterValue:1024,colour:{light:"#7eb0d5",dark:"#7eb0d5"},filter:e=>e/4095*360,axis:"degrees"},{id:"motorCurrents",title:"Motor Currents",filterValue:6144,colour:{light:"#b2e061",dark:"#b2e061"},axis:"unitless",hideSelect:!0},{id:"coilACurrent",title:"Coil A Current",filterValue:2048,colour:{light:"#b2e061",dark:"#b2e061"},axis:"unitless",hideRecord:!0},{id:"coilBCurrent",title:"Coil B Current",filterValue:4096,colour:{light:"#bd7ebe",dark:"#bd7ebe"},axis:"unitless",hideRecord:!0}],a=[{name:"Basic Tuning",value:1,disabled:!0},{name:"Encoder Calibration",value:2,disabled:!0},{name:"Step Manoeuvre",value:64,disabled:!1}]},"./src/plugins/ClosedLoopTuning/index.js":function(e,t,s){s.r(t);var i=s("./src/routes/index.ts"),l=s("./src/plugins/ClosedLoopTuning/ClosedLoopTuning.vue");(0,i.registerRoute)(l["default"],{Plugins:{ClosedLoopTuning:{icon:"mdi-chart-bell-curve-cumulative",caption:"Closed Loop",path:"/ClosedLoopTuning"}}})},"./node_modules/vuetify-loader/lib/loader.js??ruleSet[1].rules[0].use!./node_modules/thread-loader/dist/cjs.js!./node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??ruleSet[1].rules[5]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/plugins/ClosedLoopTuning/Chart.vue?vue&type=template&id=f2e130a0&scoped=true&":function(e,t,s){s.r(t),s.d(t,{render:function(){return r},staticRenderFns:function(){return n}});var i=s("./node_modules/vuetify/lib/components/VCard/VCard.js"),l=s("./node_modules/vuetify/lib/components/VCard/index.js"),a=s("./node_modules/vuetify/lib/components/VIcon/VIcon.js"),o=s("./node_modules/vuetify/lib/components/VRangeSlider/VRangeSlider.js"),r=function render(){var e=this,t=e._self._c;return t(i["default"],{staticClass:"d-flex flex-column flex-grow-1 fill-height",attrs:{"min-height":"40rem"}},[t(l.VCardTitle,{staticClass:"pt-2 pb-1"},[t(a["default"],{staticClass:"mr-2",attrs:{dense:""}},[e._v("mdi-chart-sankey")]),e._v(" Data Chart ")],1),t(l.VCardText,{staticClass:"content flex-grow-1 px-2 py-0"},[e.data?0===e.variables.length?t("div",{staticClass:"text-h4 text--disabled text-center pt-16"},[e._v(" Select some variables to plot"),t("br")]):e._e():t("div",{staticClass:"text-h4 text--disabled text-center pt-16"},[e._v(" Select a file to view ")]),e.data&&e.variables.length>0?t("div",{staticStyle:{height:"5%"}},[t(o["default"],{attrs:{"hide-details":"",max:e.data.Sample.length,min:"0"},model:{value:e.rangeFilter,callback:function(t){e.rangeFilter=t},expression:"rangeFilter"}})],1):e._e(),t("div",{directives:[{name:"show",rawName:"v-show",value:e.data&&e.variables.length>0,expression:"data && variables.length > 0"}],staticStyle:{height:"95%"}},[t("canvas",{ref:"chart"})])])],1)},n=[]},"./node_modules/vuetify-loader/lib/loader.js??ruleSet[1].rules[0].use!./node_modules/thread-loader/dist/cjs.js!./node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??ruleSet[1].rules[5]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/plugins/ClosedLoopTuning/ClosedLoopTuning.vue?vue&type=template&id=50a890d8&":function(e,t,s){s.r(t),s.d(t,{render:function(){return a},staticRenderFns:function(){return o}});var i=s("./node_modules/vuetify/lib/components/VGrid/VCol.js"),l=s("./node_modules/vuetify/lib/components/VGrid/VRow.js"),a=function render(){var e=this,t=e._self._c;return t("div",[t(l["default"],[t(i["default"],{attrs:{cols:"12"}},[t("Recorder",{attrs:{recordingProgress:-1},on:{recordingFinished:e.recordingFinished}})],1)],1),t(l["default"],[t(i["default"],{attrs:{cols:"12",sm:"6",lg:"auto",order:"1","order-lg":"0"}},[t("FileSelector",{ref:"selector",on:{fileSelect:function(t){return e.selected(t)}}})],1),t(i["default"],{staticClass:"flex-grow-1",class:{"pa-1":e.$vuetify.breakpoint.xs},attrs:{cols:"12",lg:"auto",order:"0","order-lg":"0"}},[t("Chart",{staticClass:"content flex-grow-1 px-2 py-0",attrs:{data:e.loadedData,variables:e.variablesToView}})],1),t(i["default"],{attrs:{cols:"12",sm:"6",lg:"auto",order:"1","order-lg":"0"}},[t("VariableSelector",{attrs:{"available-variables":e.availableVariables},model:{value:e.variablesToView,callback:function(t){e.variablesToView=t},expression:"variablesToView"}})],1)],1)],1)},o=[]},"./node_modules/vuetify-loader/lib/loader.js??ruleSet[1].rules[0].use!./node_modules/thread-loader/dist/cjs.js!./node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??ruleSet[1].rules[5]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/plugins/ClosedLoopTuning/FileSelector.vue?vue&type=template&id=08d365b5&":function(e,t,s){s.r(t),s.d(t,{render:function(){return v},staticRenderFns:function(){return f}});var i=s("./node_modules/vuetify/lib/components/VBtn/VBtn.js"),l=s("./node_modules/vuetify/lib/components/VCard/VCard.js"),a=s("./node_modules/vuetify/lib/components/VCard/index.js"),o=s("./node_modules/vuetify/lib/components/VDialog/VDialog.js"),r=s("./node_modules/vuetify/lib/components/VIcon/VIcon.js"),n=s("./node_modules/vuetify/lib/components/VList/VList.js"),d=s("./node_modules/vuetify/lib/components/VList/VListItem.js"),u=s("./node_modules/vuetify/lib/components/VList/index.js"),c=s("./node_modules/vuetify/lib/components/VList/VListItemGroup.js"),h=s("./node_modules/vuetify/lib/components/VPagination/VPagination.js"),m=s("./node_modules/vuetify/lib/components/VProgressCircular/VProgressCircular.js"),p=s("./node_modules/vuetify/lib/components/VGrid/VSpacer.js"),v=function render(){var e=this,t=e._self._c;return t(l["default"],{staticClass:"d-flex flex-column fill-height"},[t(a.VCardTitle,{staticClass:"pt-2 pb-1"},[t(r["default"],{staticClass:"mr-2",attrs:{small:""}},[e._v("mdi-file-table-box-multiple")]),e._v(" Data Files "),t(p["default"]),t(r["default"],{staticClass:"ml-2",on:{click:e.refresh}},[e._v("mdi-refresh")]),e.isDeleting?t(m["default"],{staticClass:"disable-transition ml-2",attrs:{size:"24",value:e.deleteProgress}}):t(r["default"],{staticClass:"ml-2",on:{click:function(t){e.deleteDialog=!0}}},[e._v("mdi-delete")])],1),t(a.VCardText,{staticClass:"pb-0"},[t(n["default"],{attrs:{dense:"","v-if":!e.loading}},[e.files.length>200?t("div",{staticClass:"w-full error--text text-center mb-3"},[e._v(" Warning: You have "+e._s(this.files.length)+" data files"),t("br"),e._v(" You may wish to delete some to save space ")]):e._e(),t(c["default"],{attrs:{color:"primary"},model:{value:e.selectedIndex,callback:function(t){e.selectedIndex=t},expression:"selectedIndex"}},e._l(e.displayedFiles,(function(s,i){return t(d["default"],{key:s.name,attrs:{value:i}},[t(u.VListItemContent,[t(u.VListItemTitle,[t("div",{staticClass:"mt-1 float-left"},[e._v(" "+e._s(s.name)+" ")]),t(r["default"],{staticClass:"ml-2 float-right",on:{click:function(t){return t.stopPropagation(),e.deleteFile(s.name)}}},[e._v("mdi-delete")])],1)],1)],1)})),1)],1),t(o["default"],{attrs:{value:e.deleteDialog,width:"480",persistent:""}},[t(l["default"],[t(a.VCardTitle,[e._v(" Delete All Files ")]),t(a.VCardText,[e._v(" Are you sure you want to delete all CSV files? ")]),t(a.VCardActions,[t(p["default"]),t(i["default"],{staticClass:"mr-1",attrs:{color:"error"},on:{click:function(t){return e.deleteAll()}}},[e._v("Delete")]),t(i["default"],{on:{click:function(t){e.deleteDialog=!1}}},[e._v("Cancel")])],1)],1)],1)],1),t(p["default"]),t(a.VCardActions,[t(h["default"],{staticClass:"mx-auto",attrs:{length:Math.ceil(e.files.length/e.maxFileDisplay),"total-visible":Math.ceil(e.files.length/e.maxFileDisplay)>4?5:null},model:{value:e.page,callback:function(t){e.page=t},expression:"page"}})],1)],1)},f=[]},"./node_modules/vuetify-loader/lib/loader.js??ruleSet[1].rules[0].use!./node_modules/thread-loader/dist/cjs.js!./node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??ruleSet[1].rules[5]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/plugins/ClosedLoopTuning/Recorder.vue?vue&type=template&id=3b40ed2e&":function(e,t,s){s.r(t),s.d(t,{render:function(){return b},staticRenderFns:function(){return x}});var i=s("./node_modules/vuetify/lib/components/VBtn/VBtn.js"),l=s("./node_modules/vuetify/lib/components/VCard/VCard.js"),a=s("./node_modules/vuetify/lib/components/VCard/index.js"),o=s("./node_modules/vuetify/lib/components/VCheckbox/VCheckbox.js"),r=s("./node_modules/vuetify/lib/components/VGrid/VCol.js"),n=s("./node_modules/vuetify/lib/components/VDialog/VDialog.js"),d=s("./node_modules/vuetify/lib/components/VForm/VForm.js"),u=s("./node_modules/vuetify/lib/components/VIcon/VIcon.js"),c=s("./node_modules/vuetify/lib/components/VProgressLinear/VProgressLinear.js"),h=s("./node_modules/vuetify/lib/components/VRadioGroup/VRadio.js"),m=s("./node_modules/vuetify/lib/components/VRadioGroup/VRadioGroup.js"),p=s("./node_modules/vuetify/lib/components/VGrid/VRow.js"),v=s("./node_modules/vuetify/lib/components/VSelect/VSelect.js"),f=s("./node_modules/vuetify/lib/components/VGrid/VSpacer.js"),g=s("./node_modules/vuetify/lib/components/VTextField/VTextField.js"),b=function render(){var e=this,t=e._self._c;return t(l["default"],{staticClass:"fill-height"},[t(a.VCardTitle,{staticClass:"pt-2 pb-1"},[t(u["default"],{staticClass:"mr-2"},[e._v("mdi-record-rec")]),e._v(" Record ")],1),t(a.VCardText,[t(p["default"],[e._l([0,1,2],(function(s){return t(r["default"],{key:s,attrs:{cols:"2"}},e._l(e.nthThirdOfVariables(s),(function(s){return t(o["default"],{key:s.id,attrs:{dense:"","hide-details":"",label:s.title,value:s,color:e.darkTheme?s.colour.dark:s.colour.light},model:{value:e.selectedVariables,callback:function(t){e.selectedVariables=t},expression:"selectedVariables"}})})),1)})),t(r["default"],{attrs:{cols:"3"}},[t(v["default"],{staticClass:"pb-4",attrs:{items:e.drivers,hint:"Only one motor will be driven, axis should be re-homed after tuning","item-text":"name","item-value":"value",label:"Select a driver","single-line":"","persistent-hint":""},model:{value:e.selectedDriver,callback:function(t){e.selectedDriver=t},expression:"selectedDriver"}}),t(d["default"],{on:{submit:function(t){return t.preventDefault(),e.updatePID.apply(null,arguments)},keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.updatePID.apply(null,arguments)}}},[t(p["default"],{attrs:{dense:""}},[t(r["default"],{attrs:{cols:"4"}},[t(g["default"],{attrs:{label:"P Value",numeric:""},model:{value:e.pTerm,callback:function(t){e.pTerm=t},expression:"pTerm"}})],1),t(r["default"],{attrs:{cols:"4"}},[t(g["default"],{attrs:{label:"I Value",numeric:""},model:{value:e.iTerm,callback:function(t){e.iTerm=t},expression:"iTerm"}})],1),t(r["default"],{attrs:{cols:"4"}},[t(g["default"],{attrs:{label:"D Value",numeric:""},model:{value:e.dTerm,callback:function(t){e.dTerm=t},expression:"dTerm"}})],1),t(r["default"],{attrs:{cols:"4"}},[t(g["default"],{attrs:{label:"A Value",numeric:""},model:{value:e.aTerm,callback:function(t){e.aTerm=t},expression:"aTerm"}})],1),t(r["default"],{attrs:{cols:"4"}},[t(g["default"],{attrs:{label:"V Value",numeric:""},model:{value:e.vTerm,callback:function(t){e.vTerm=t},expression:"vTerm"}})],1),t(r["default"],{attrs:{cols:"4"}},[t(i["default"],{attrs:{type:"submit",loading:e.updatingPIDValue}},[e._v("Update")])],1)],1)],1),t(p["default"],[t(r["default"],{attrs:{cols:"6"}},[t(g["default"],{attrs:{label:"Samples to collect",rules:[t=>!!t||e.$t("dialog.inputRequired"),t=>e.isNumber(parseFloat(t))||e.$t("dialog.numberRequired")],required:"",autofocus:""},scopedSlots:e._u([{key:"append",fn:function(){return[e._v(" samples ")]},proxy:!0}]),model:{value:e.sampleCount,callback:function(t){e.sampleCount=t},expression:"sampleCount"}})],1),t(r["default"],{attrs:{cols:"6"}},[t(m["default"],{model:{value:e.sampleRateContinuous,callback:function(t){e.sampleRateContinuous=t},expression:"sampleRateContinuous"}},[t(h["default"],{attrs:{label:"As fast as possible",value:!0,dense:"","hide-details":""}}),t(h["default"],{attrs:{value:!1,dense:"","hide-details":""},scopedSlots:e._u([{key:"label",fn:function(){return[t(g["default"],{attrs:{label:"At a fixed rate",rules:[t=>!!t||e.$t("dialog.inputRequired"),t=>e.isNumber(parseFloat(t))||e.$t("dialog.numberRequired")],required:"",autofocus:"",hint:e.sampleRateContinuous?"":`(total ${e.totalTime} seconds)`,"persistent-hint":""},model:{value:e.sampleRate,callback:function(t){e.sampleRate=t},expression:"sampleRate"}},[t("template",{slot:"append"},[e._v(" /second ")])],2)]},proxy:!0}])})],1)],1)],1)],1),t(r["default"],{attrs:{cols:"3"}},[t(m["default"],{staticClass:"mt-0 pt-0",attrs:{label:"Movement"},model:{value:e.calibrationMovement,callback:function(t){e.calibrationMovement=t},expression:"calibrationMovement"}},[t(h["default"],{attrs:{value:64,label:"Step Manoeuvre",dense:"","hide-details":""}}),t(p["default"],{directives:[{name:"show",rawName:"v-show",value:64===e.calibrationMovement,expression:"calibrationMovement === 64"}],attrs:{dense:""}},[t(r["default"],{attrs:{cols:"12"}},[e._v(" Step Manoeuvre Parameters ")]),t(r["default"],{attrs:{cols:"6"}},[t(g["default"],{attrs:{label:"Speed","persistent-hint":"",rules:[t=>!!t||e.$t("dialog.inputRequired"),t=>e.isNumber(parseFloat(t))||e.$t("dialog.numberRequired")],required:"",autofocus:""},scopedSlots:e._u([{key:"append",fn:function(){return[e._v(" mm/s ")]},proxy:!0}]),model:{value:e.moveSpeed,callback:function(t){e.moveSpeed=t},expression:"moveSpeed"}})],1),t(r["default"],{attrs:{cols:"6"}},[t(g["default"],{attrs:{label:"Distance",rules:[t=>!!t||e.$t("dialog.inputRequired"),t=>e.isNumber(parseFloat(t))||e.$t("dialog.numberRequired")],required:"",autofocus:""},scopedSlots:e._u([{key:"append",fn:function(){return[e._v(" mm ")]},proxy:!0}]),model:{value:e.moveDistance,callback:function(t){e.moveDistance=t},expression:"moveDistance"}})],1),t(r["default"],{attrs:{cols:"6"}},[t(g["default"],{attrs:{label:"Acceleration",rules:[t=>!!t||e.$t("dialog.inputRequired"),t=>e.isNumber(parseFloat(t))||e.$t("dialog.numberRequired")],required:"",autofocus:""},scopedSlots:e._u([{key:"append",fn:function(){return[e._v(" mm/s^2 ")]},proxy:!0}]),model:{value:e.moveAcceleration,callback:function(t){e.moveAcceleration=t},expression:"moveAcceleration"}})],1)],1),t(h["default"],{attrs:{value:0,"hide-details":"",label:"Custom G-Code"}}),t(p["default"],{directives:[{name:"show",rawName:"v-show",value:0===e.calibrationMovement,expression:"calibrationMovement === 0"}],attrs:{dense:""}},[t(r["default"],{attrs:{cols:"12"}},[t(g["default"],{staticClass:"pt-1",attrs:{label:"G-Code","persistent-hint":"",hint:"Enter custom g-code to record"},model:{value:e.customGCODE,callback:function(t){e.customGCODE=t},expression:"customGCODE"}})],1)],1)],1),t(v["default"],{attrs:{items:[{text:"Immediately",value:0},{text:"On next move",value:1}],label:"Collect data"},model:{value:e.activateMode,callback:function(t){e.activateMode=t},expression:"activateMode"}})],1)],2),t(p["default"],[t(r["default"],{attrs:{cols:"auto"}},[t(i["default"],{attrs:{disabled:!e.ready||e.autoTuning||e.recording,color:"info"},on:{click:function(t){return e.record()}}},[t(u["default"],{staticClass:"mr-2"},[e._v("mdi-record")]),e._v(" Record ")],1),t(i["default"],{staticClass:"ml-1",attrs:{disabled:null==e.selectedDriver||e.autoTuning,color:"info"},on:{click:function(t){return e.autoTune()}}},[t(u["default"],[e._v("mdi-tune")]),t("span",{staticClass:"ml-1"},[e._v("Auto Tune")])],1),e.autoTuning?t(i["default"],{staticClass:"ml-1",attrs:{color:"error"},on:{click:function(t){return e.cancelAutoTune()}}},[t(u["default"],[e._v("mdi-tune")]),t("span",{staticClass:"ml-1"},[e._v("Cancel")])],1):e._e(),t("div",{staticClass:"mt-1"},[e._v(e._s(e.autoTuneText))])],1),t(r["default"],{attrs:{cols:"10"}},[e.ready?t("div",{staticClass:"font-weight-black info--text",class:{"pt-2":!e.error&&!e.warning&&null==e.recordingProgress&&0!=e.calibrationMovement}},[e._v(e._s(e.GCODECommand))]):e._e(),e.ready&&0==e.calibrationMovement?t("div",{staticClass:"font-weight-black info--text"},[e._v(e._s(e.customGCODE))]):e._e(),e.error?t("div",{staticClass:"font-weight-black error--text"},[e._v(e._s(e.error))]):e._e(),e.warning?t("div",{staticClass:"font-weight-black warning--text"},[e._v(e._s(e.warning))]):e._e(),null!=e.recordingProgress?t(c["default"],{staticClass:"mb-4",attrs:{indeterminate:-1==e.recordingProgress,value:-1==e.recordingProgress?0:e.recordingProgress}}):e._e()],1)],1)],1),t(n["default"],{attrs:{persistent:"",width:"480"},model:{value:e.showDialog,callback:function(t){e.showDialog=t},expression:"showDialog"}},[t(l["default"],[t(a.VCardTitle,[t("span",{staticClass:"headline"},[e._v(" Confirm ")])]),t(a.VCardText,[e._v(" You have chosen to perform a tuning manoeuvre which will move the axis a small distance. "),t("div",{staticClass:"text-center py-2 font-weight-black error--text"},[e._v("This movement may not respect endstops.")]),e._v(" Please ensure the axis is in a safe position (usually the center) before proceeding. ")]),t(a.VCardActions,[t(i["default"],{attrs:{color:"error darken-1",text:""},on:{click:function(t){return e.dialogResult(!1)}}},[e._v(" "+e._s(e.$t("generic.cancel"))+" ")]),t(f["default"]),t(o["default"],{staticClass:"pr-2",scopedSlots:e._u([{key:"label",fn:function(){return[t("span",{staticStyle:{"font-size":"0.7em"}},[e._v("Don't show this again")])]},proxy:!0}]),model:{value:e.dontShowModal,callback:function(t){e.dontShowModal=t},expression:"dontShowModal"}}),t(i["default"],{attrs:{color:"blue darken-1",text:""},on:{click:function(t){return e.dialogResult(!0)}}},[e._v(" "+e._s(e.$t("generic.ok"))+" ")])],1)],1)],1)],1)},x=[]},"./node_modules/vuetify-loader/lib/loader.js??ruleSet[1].rules[0].use!./node_modules/thread-loader/dist/cjs.js!./node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??ruleSet[1].rules[5]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/plugins/ClosedLoopTuning/VariableSelector.vue?vue&type=template&id=7ec396c0&":function(e,t,s){s.r(t),s.d(t,{render:function(){return d},staticRenderFns:function(){return u}});var i=s("./node_modules/vuetify/lib/components/VBtn/VBtn.js"),l=s("./node_modules/vuetify/lib/components/VCard/VCard.js"),a=s("./node_modules/vuetify/lib/components/VCard/index.js"),o=s("./node_modules/vuetify/lib/components/VCheckbox/VCheckbox.js"),r=s("./node_modules/vuetify/lib/components/VIcon/VIcon.js"),n=s("./node_modules/vuetify/lib/components/VGrid/VSpacer.js"),d=function render(){var e=this,t=e._self._c;return t(l["default"],{staticClass:"d-flex flex-column fill-height"},[t(a.VCardTitle,{staticClass:"pt-2 pb-1"},[t(r["default"],{staticClass:"mr-2",attrs:{small:""}},[e._v("mdi-function-variant")]),e._v(" Variables ")],1),t(a.VCardText,{staticClass:"content flex-grow-1 px-2 py-0 pr-4"},e._l(e.chartableVariables,(function(s){return t(o["default"],{key:s.id,attrs:{dense:"","hide-details":"",label:s.title,value:s,disabled:!e.availableVariables.includes(s.title),color:e.darkTheme?s.colour.dark:s.colour.light},model:{value:e.selectedVariables,callback:function(t){e.selectedVariables=t},expression:"selectedVariables"}})})),1),t(n["default"]),t(a.VCardActions,{staticClass:"d-flex"},[t(i["default"],{attrs:{color:"darken-1"},on:{click:e.selectAll}},[e._v("All")]),t(n["default"]),t(i["default"],{attrs:{color:"darken-1"},on:{click:function(t){e.selectedVariables=[]}}},[e._v("None")])],1)],1)},u=[]}}]);
//# sourceMappingURL=ClosedLoopTuning.1d7cf1e1.js.map